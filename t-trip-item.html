<link rel="import" href="../polymer/polymer.html" />
<link rel="import" href="./t-air-item.html">
<link rel="import" href="./t-hotel-item.html">
<link rel="import" href="./t-activity-item.html">
<link rel="import" href="./t-car-item.html">
<!--
    `t-trip-item` is trip listing item component.
    This component shows information of a single trip.
    It may contain one or more product depending upon booked itineraries.
	
	
Example:
        without event handlers
        <t-trip-api></t-trip-api>

        with data
        <t-list id="list" data-api="result.json" as="item" token-param="bookings" auto>
            <template>
                <t-trip-item trip="{{item}}"></t-trip-item>
            </template>
        </t-list>-->
<dom-module id="t-trip-item">
    <template>
        <div>trip name - {{name}}</div>
        <div>trip id - {{tripId}}</div>
        <div>delete link</div>
        <div>details link</div>
        <div>statyus - {{status}}</div>
        <br>
        <div>
            <template is="dom-repeat" items="{{tripProducts}}">
                <template is="dom-if" if="{{_isAir(item)}}">
                    <h3>air</h3>
                    <t-air-item model="{{item}}"></t-air-item>
                    <br>
                </template>
                <template is="dom-if" if="{{_isHotel(item)}}">
                    <br>
                    <h3>hotel</h3>
                    <t-hotel-item model="{{item}}"></t-hotel-item>
                    <br>
                </template>
                <template is="dom-if" if="{{_isActivity(item)}}">
                    <br>
                    <h3>activity</h3>
                    <t-activity-item inventory="{{item}}"></t-activity-item>
                    <br>
                </template>
                <template is="dom-if" if="{{_isCar(item)}}">
                    <br>
                    <h3>car</h3>
                    <t-car-item model="{{item}}"></t-car-item>
                    <br>
                </template>
            </template>
        </div>
    </template>
</dom-module>
<script>
Polymer({
    is: "t-trip-item",

    properties: {

        /**
         * trip name.
         * This is required field.
         */
        name: {
            type: String,
            value: ''
        },

        /**
         * trip id.
         * This is required field.
         */
        tripId: {
            type: String,
            value: ''
        },

        /**
         * list of booked inventories.
         */
        tripProducts: {
            type: Array,
            value: []
        },

        /**
         * trip item.
         * This is required field.
         */
        trip: {
            type: Object,
            value: {},
            observer: 'populateModel'
        },

        /**
         * trip status.
         * This is required field.
         */
        status: {
            type: String,
            value: ''
        }
    },

    attached: function() {
        if (!this.trip)
            console.error("trip not found!");
        if (!this.tripProducts)
            this.tripProducts = this.trip.inventoriesInfo;
    },

    populateModel: function() {
        if (!this.trip)
            console.error("trip not found!");

        if (!this.tripProducts.length && this.trip.inventoriesInfo)
            this.tripProducts = this.trip.inventoriesInfo;

        this.name = this.trip.name;
        this.tripId = this.trip.confirmationNumber;
        this.status = this.trip.bookingStatus;
    },

    _isAir: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'flight';
    },

    _isHotel: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'hotel';
    },

    _isActivity: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'activity';
    },

    _isCar: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'car';
    }
});
</script>
