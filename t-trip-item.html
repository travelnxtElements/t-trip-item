<link rel="import" href="../polymer/polymer.html" />
<link rel="import" href="./t-air-item.html">
<link rel="import" href="./t-hotel-item.html">
<link rel="import" href="./t-activity-item.html">
<link rel="import" href="./t-car-item.html">
<dom-module id="t-trip-item">
    <template>
        <div>{{name}}</div>
        <div>{{tripId}}</div>
        <div>delete link</div>
        <div>details link</div>
        <div>{{status}}</div>
        <br>
        <div>
            <template is="dom-repeat" items="{{tripProducts}}">
                <template is="dom-if" if="{{_isAir(item)}}">
                    <t-air-item inventory="{{item}}"></t-air-item>
                    <br>
                </template>
                <template is="dom-if" if="{{_isHotel(item)}}">
                    <t-hotel-item inventory="{{item}}"></t-hotel-item>
                    <br>
                </template>
                <template is="dom-if" if="{{_isActivity(item)}}">
                    <t-activity-item inventory="{{item}}"></t-activity-item>
                    <br>
                </template>
                <template is="dom-if" if="{{_isCar(item)}}">
                    <t-car-item inventory="{{item}}"></t-car-item>
                    <br>
                </template>
            </template>
        </div>
    </template>
</dom-module>
<script>
Polymer({
    is: "t-trip-item",

    properties: {

        name: {
            type: String,
            value: ''
        },

        tripId: {
            type: String,
            value: ''
        },

        tripProducts: {
            type: Array,
            value: []
        },

        trip: {
            type: Object,
            value: {},
            observer: 'populateModel'
        },

        status: {
            type: String,
            value: ''
        }
    },

    attached: function() {
        if (!this.trip)
            console.error("trip not found!");
        if (!this.tripProducts)
            this.tripProducts = this.trip.inventoriesInfo;
        // this.populateModel();
    },

    populateModel: function() {
        if (!this.trip)
            console.error("trip not found!");

        if (!this.tripProducts.length && this.trip.inventoriesInfo)
            this.tripProducts = this.trip.inventoriesInfo;

        this.name = this.trip.name;
        this.tripId = this.trip.confirmationNumber;
        this.status = this.trip.bookingStatus;
    },

    _isAir: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'flight';
    },

    _isHotel: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'hotel';
    },

    _isActivity: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'activity';
    },

    _isCar: function(product) {
        if (!product || !product.inventory)
            console.error("inventory not found!");

        return product.inventory.type.toLowerCase() === 'car';
    }
});
</script>
